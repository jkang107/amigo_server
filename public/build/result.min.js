function sendLoginInfo(a){var b=preURL+"/sendLoginInfo";response=$.post(b,{userInfo:a}),response.success(function(a){}),response.error(function(a){})}function afterLogin(a){var b;b=null===a.properties.thumbnail_image?"./images/profile.png":a.properties.thumbnail_image,$("#login_container").prepend('<img id="profil_img" src="'+b+'" class="img-circle profile" alt="thumbnail">'),$("#login_name").text(a.properties.nickname),$("#login_name").css({"float":"left","margin-left":"-13px"}),$("#login_fade").css("display","none"),$("#login").css("display","none"),$("#login_container").addClass("dropdown dropdown-btn"),$("#login_name").attr("data-toggle","dropdown").addClass("dropdown-toggle").append("<b class='caret'></b>"),$("#login_container").append('<ul class="dropdown-menu"><li><a href="/mylist">내가 올린 글 보기</a></li><li class="divider"></li><li><a onclick="javascript:kakao_logout()">Logout</a></li></ul>'),isPressNewBtn&&$("#createTravel").css("z-index","1040"),localStorage.setItem("id",a.id),localStorage.setItem("thumbnail",b),localStorage.setItem("nickname",a.properties.nickname)}function afterLogout(){$("#login_name").text("로그인"),$("#login_name").css({"float":"","margin-left":"0px"}),$("#profil_img").remove(),$("#login_name").removeAttr("data-toggle").removeClass("dropdown-toggle"),$("b .caret").remove(),$(".dropdown-menu").remove(),localStorage.removeItem("id"),localStorage.removeItem("thumbnail"),localStorage.removeItem("nickname")}function viewMyAccount(){window.location.href="/mylist"}function loginWithKakao(){}function kakao_logout(){Kakao.Auth.logout(),isLogin=!1,afterLogout()}function initialize(){var a={types:["(cities)"]},b=document.getElementById("move_from");new google.maps.places.Autocomplete(b,a)}function popupLoginWindow(){isLogin||($("#login").css("visibility","visible"),$("#login_fade").css("display","block"),event.preventDefault())}function returnTravelType(a){switch(a){case"travelWith":titleImage="travel_man_64.png";break;case"moveWith":titleImage="taxi_64.png";break;case"tourWith":titleImage="biking_64.png";break;case"foodWith":titleImage="food_64.png"}}function createNewTravel(a){tmp_new_travel=a,stampCurrentTime(),sendToServer(a)}function createNewObject(a,b){$("#accordion").prepend("<div id='object_"+b+"' class='mix panel panel-default'></div>"),$("#object_"+b).append("<div class='panel-heading' role='tab' id='heading_"+b+"'><div class='panel-title mylist-panel-title'><a index="+a.index+" data-toggle='collapse' id='heading_t_"+b+"' class='clipped line_container' data-parent='#accordion' href='#collapse_"+b+"' aria-expanded='false' aria-controls='collapse_"+b+"'></a></div></div>"),$("#object_"+b).append("<div id='collapse_"+b+"' class='panel-collapse collapse' role='tabpanel' aria-labelledby='collapse_"+b+"'><div class='panel-body'>"+a.comment+"<br/></div></div>");var c=$("#heading_t_"+b),d=$("<div class='img_div'></div>");c.append(d),d.append("<img src='"+a.kakao_thumbnail+"' class='img-circle inner_list' alt='kakaotalk thumbnail' width='40' height='40'>"),d.append("<img src='./bootstrap/images/"+titleImage+"' class='inner_list' alt='travel' width='40' height='40'>");var e;e=void 0!==info_div_width&&window.innerWidth<768?$("<div class='info_div' style='width:"+info_div_width+"px'></div>"):$("<div class='info_div'></div>"),c.append(e),c=e;var f=a.sex;c.append("<span id='_gender' class='inner_text'></span>"),f="man"==f?"남":"woman"==f?"여":"2명이상",$("#_gender").text(f).addClass("inner_text_gender");var g=a.age.split("_")[1]+"대";c.append("<span id='_age' class='inner_text inner_text_gender'>"+g+"</span>");var h;if(a.country_from instanceof Array||a.country_from.split(",").length>1){var i=new Array;i="string"==typeof a.country_from?a.country_from.split(","):a.country_from;for(var j=0;j<i.length;j++){switch(i[j]){case"멕시코":h="mexico";break;case"콜롬비아":h="colombia";break;case"에콰도르":h="equador";break;case"페루":h="peru";break;case"볼리비아":h="bolivia";break;case"칠레":h="chile";break;case"아르헨티나":h="argentina";break;case"브라질":h="brazil"}$("#object_"+b).addClass(h)}}else{switch(a.country_from){case"멕시코":h="mexico";break;case"콜롬비아":h="colombia";break;case"에콰도르":h="equador";break;case"페루":h="peru";break;case"볼리비아":h="bolivia";break;case"칠레":h="chile";break;case"아르헨티나":h="argentina";break;case"브라질":h="brazil"}$("#object_"+b).addClass(h)}var k;if("string"==typeof a.country_from?(k=a.country_from.split(","),k.length>2&&(k=k.slice(0,2).toString()+" 외 "+(k.length-2)+"개국")):k=a.country_from.length>2?a.country_from.slice(0,2)+" 외 "+(a.country_from.length-2)+"개국":a.country_from.toString(),c.append("<span id='_country_from' class='inner_text inner_country'>"+k+"</span>"),null!==a.transportation){var l=a.transportation;switch(l){case"bus":l="버스이동";break;case"taxi":l="택시이동";break;case"metro":l="지하철이동"}c.append("<span id='_transportation' class='inner_text inner_text_trans'>#"+l+"</span>")}null!==a.city_from&&c.append("<span id='_city_from' class='inner_text'>#"+a.city_from+"</span>"),null!==a.tour_name&&c.append("<span id='_tour_name' class='inner_text'>#"+a.tour_name+"</span>");var m=a.when_from.split("/");if(m=m[0]+"월"+m[1]+"일",null!==a.when_to){var n=a.when_to.split("/");n=n[0]+"월"+n[1]+"일",c.append("<span id='_when_to' class='inner_text inner_text_date'>"+m+" ~ "+n+"</span>")}else c.append("<span id='_when_to' class='inner_text inner_text_date'>"+m+"</span>");isMyListPage&&(window.innerWidth<760?c.parent().append("<span id='delete_"+b+"'class='mylist-delete-btn delete-item glyphicon glyphicon-remove-circle btn-lg' aria-hidden='true'></span>"):c.append("<span id='delete_"+b+"'class='mylist-delete-btn delete-item glyphicon glyphicon-remove-circle btn-lg' aria-hidden='true'></span>"),$("#delete_"+b).click(function(a){var b;b=window.innerWidth<760?parseInt($(a.target).prev().attr("index")):parseInt(a.target.parentNode.parentNode.attributes.index.value),bootbox.confirm({size:"small",message:"정말 삭제하시겠습니까?",callback:function(c){c===!0&&deleteItem(b,parseInt(a.target.id.split("_")[1]))}})})),isNewElement&&($("#accordion").mixItUp("prepend",$("object_"+b),{filter:"all"}),isNewElement=!1),b++}function stampCurrentTime(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear(),e=a.getHours(),f=a.getMinutes(),g=a.getSeconds();currentTime=d+"/"+c+"/"+b+" "+e+":"+f+":"+g}function sendToServer(a){var b=preURL+"/sendTravelInfo";deferred=$.post(b,{travelInfo:a,time:currentTime}),deferred.success(function(a){isNewElement=!0,numOfTravel++,createNewObject(tmp_new_travel,numOfTravel)}),deferred.error(function(a){})}function getTravelList(){var a=document.getElementById("travelList_container"),b=(new Spinner).spin();a.appendChild(b.el);var c=preURL+"/getTravelList";$.ajax({type:"GET",url:c,success:function(a){b.stop(),numOfTravel=a.length;for(var c=0;numOfTravel>c;c++)returnTravelType(a[c].type),createNewObject(a[c],c+1);$("#accordion").mixItUp({layout:{display:"block"}})},error:function(a,c){b.stop()}})}function getMyList(){var a=document.getElementById("travelList_container"),b=(new Spinner).spin();a.appendChild(b.el);var c=preURL+"/getMyList";deferred=$.post(c,{kakaoid:localStorage.getItem("id")}),deferred.success(function(a){b.stop(),numOfTravel=a.length,isMyListPage=!0;for(var c=0;numOfTravel>c;c++)returnTravelType(a[c].type),createNewObject(a[c],c+1)}),deferred.error(function(a){b.stop()})}function deleteItem(a,b){tmp_delete_index=b;var c=preURL+"/deleteItem";deferred=$.post(c,{index:a}),deferred.success(function(a){$("#object_"+tmp_delete_index).remove()}),deferred.error(function(a){})}function checkLoginStatus(){null!==localStorage.getItem("id")&&null!==localStorage.getItem("thumbnail")&&(isLogin=!0,$("#login_container").prepend('<img id="profil_img" src="'+localStorage.getItem("thumbnail")+'" class="img-circle profile" alt="profile">'),$("#login_name").text(localStorage.getItem("nickname")),$("#login_name").css({"float":"left","margin-left":"-13px"}),$("#login_name").attr("data-toggle","dropdown").addClass("dropdown-toggle").append("<b class='caret'></b>"),$("#login_container").append('<ul class="dropdown-menu"><li><a href="/mylist">내가 올린 글 보기</a></li><li class="divider"></li><li><a onclick="javascript:kakao_logout()">Logout</a></li></ul>'))}function validate(){var a=$("#kakaoID");a.val()||e.preventDefault()}var preURL="http://findyourtravelbuddy.herokuapp.com";Kakao.init("8153126b123d384678442ece2cfd1ed8"),Kakao.Auth.createLoginButton({container:"#kakao-login-btn",success:function(a){Kakao.API.request({url:"/v1/user/me",success:function(a){sendLoginInfo(a),isLogin=!0,afterLogin(a)},fail:function(a){alert(JSON.stringify(a))}})},fail:function(a){}}),google.maps.event.addDomListener(window,"load",initialize);var containerNum=1,panelStyle,titleImage,user_kakaotalk_thumbnail,chooseTravelType=function(){var a=event.target.id;switch($("#type"+containerNum+"_container").css("display","none"),a){case"travelWith":containerNum=1;break;case"moveWith":containerNum=2;break;case"tourWith":containerNum=3;break;case"foodWith":containerNum=4}$("#type"+containerNum+"_container").css("display","block")},addNewTravel=function(){$("#createTravel").modal("hide");var a,b=$("#travel_type").find(".active").get(0).id,c={userId:localStorage.getItem("id"),travel_type:b,sex:$("#client_gender").find(".active").children().get(0).id,age:$("#client_age").find(".active").children().get(0).id,when_from:null,when_to:null,country_from:null,city_from:null,country_to:null,city_to:null,transportation:null,tour_name:null,comment:null,kakao_thumbnail:localStorage.getItem("thumbnail")};switch(b){case"travelWith":var d=[];$("#travel_country").find(".active").each(function(){d.push($(this).text())});var e=$("#travel_date_from").val(),f=$("#travel_date_to").val();a='<span class="comment_type_txt"><i class="fa fa-quote-left"></i> 같이 여행해요 <i class="fa fa-quote-right"></i></span><br><br><span class="comment_title_txt"><i class="fa fa-check"></i> When? </span>'+e+" - "+f+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> Where? </span>'+d.toString()+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> 카톡 ID: </span>'+$("#kakaoID").val()+'<br><span class="comment_title_txt"><i class="fa fa-comments"></i> Comment<br></span> '+$("#travel_detail1").val().replace(/\n/g,"<br/>"),c.travel_type=b,c.when_from=e,c.when_to=f,c.country_from=d,c.comment=a,titleImage="travel_man_64.png";break;case"moveWith":e=$("#move_when").val();var g=$("#move_from_country option:selected").val(),h=$("#move_from").val(),i=$("#move_to_country option:selected").val(),j=$("#move_to").val();a='<span class="comment_type_txt"><i class="fa fa-quote-left"></i> 같이 이동해요 <i class="fa fa-quote-right"></i></span><br><br><span class="comment_title_txt"><i class="fa fa-check"></i> When? </span>'+e+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> Where? </span>'+g+"/"+h+' <i class="fa fa-long-arrow-right"></i> '+i+"/"+j+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> 카톡 ID: </span>'+$("#kakaoID").val()+'<br><span class="comment_title_txt"><i class="fa fa-comments"></i> Comment<br></span> '+$("#travel_detail2").val().replace(/\n/g,"<br/>"),c.travel_type=b,c.when_from=e,c.country_from=g,c.city_from=h,c.country_to=i,c.city_to=j,c.transportation=$("#transportation_button").find(".active").children().get(0).id,c.comment=a,titleImage="taxi_64.png";break;case"tourWith":e=$("#tour_date_from").val();var f=$("#tour_date_to").val(),g=$("#tour_contry option:selected").val(),k=$("#tour_name").val();a='<span class="comment_type_txt"><i class="fa fa-quote-left"></i> 같이 투어/트레킹해요 <i class="fa fa-quote-right"></i></span><br><br><span class="comment_title_txt"><i class="fa fa-check"></i> When? </span>'+e+" - "+f+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> Where? </span>'+g+"/"+k+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> 카톡 ID: </span>'+$("#kakaoID").val()+'<br><span class="comment_title_txt"><i class="fa fa-comments"></i> Comment<br></span> '+$("#travel_detail3").val().replace(/\n/g,"<br/>"),c.travel_type=b,c.when_from=e,c.when_to=f,c.country_from=g,c.tour_name=k,c.comment=a,titleImage="biking_64.png";break;case"foodWith":e=$("#food_when").val(),g=$("#food_country option:selected").val();var h=$("#food_city").val();a='<span class="comment_type_txt"><i class="fa fa-quote-left"></i> 같이 식사해요 <i class="fa fa-quote-right"></i></span><br><br><span class="comment_title_txt"><i class="fa fa-check"></i> When? </span>'+e+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> Where? </span>'+g+"/"+h+'<br><span class="comment_title_txt"><i class="fa fa-check"></i> 카톡 ID: </span>'+$("#kakaoID").val()+'<br><span class="comment_title_txt"><i class="fa fa-comments"></i> Comment<br></span> '+$("#travel_detail4").val().replace(/\n/g,"<br/>"),c.travel_type=b,c.when_from=e,c.country_from=g,c.city_from=h,c.comment=a,titleImage="food_64.png"}createNewTravel(c)},isLogin=!1,isPressNewBtn=!1,showTravelForm=function(){isLogin?isPressNewBtn=!0:($("#createTravel").css("z-index","-1"),isPressNewBtn=!0,popupLoginWindow())};$("#login_fade").click(function(){$("#login_fade").css("display","none"),$("#login").css("visibility","hidden")}),$("#login_close_btn").click(function(){$("#login_fade").css("display","none"),$("#login").css("visibility","hidden")});var tmp_new_travel,numOfTravel=0,info_div_width=0,currentTime,isNewElement=!1,tmp_delete_index=0;$("input#sendMail").click(function(){var a=preURL+"/sendMail";deferred=$.post(a,{name:$("#name2").val(),from:$("#email2").val(),message:$("#message2").val()}),deferred.success(function(a){}),deferred.error(function(a){})});var isMyListPage=!1;!function(a){a(document).ready(function(){a(".banner-image").backstretch("images/DSC00605.JPG"),a(".mylist-image").backstretch("images/portfolio-1.jpg"),a(window).scroll(function(){a(".header.fixed").length>0&&(a(this).scrollTop()>0&&a(window).width()>767?a("body").addClass("fixed-header-on"):a("body").removeClass("fixed-header-on"))}),a(window).load(function(){a(".header.fixed").length>0&&(a(this).scrollTop()>0&&a(window).width()>767?a("body").addClass("fixed-header-on"):a("body").removeClass("fixed-header-on"))}),a(".scrollspy").length>0&&(a("body").addClass("scroll-spy"),a("body").scrollspy({target:".scrollspy",offset:152})),a(".smooth-scroll").length>0&&a(".smooth-scroll a[href*=#]:not([href=#]), a[href*=#]:not([href=#]).smooth-scroll").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var b=a(this.hash);if(b=b.length?b:a("[name="+this.hash.slice(1)+"]"),b.length){var c=a(window).width(),d=151;return 767>c&&(d-=76),a("html,body").animate({scrollTop:b.offset().top-d},1e3),!1}}}),a("[data-animation-effect]").length>0&&!Modernizr.touch&&a("[data-animation-effect]").each(function(){var b=a(this),c=b.attr("data-animation-effect");Modernizr.mq("only all and (min-width: 768px)")&&Modernizr.csstransitions?b.appear(function(){setTimeout(function(){b.addClass("animated object-visible "+c)},400)},{accX:0,accY:-130}):b.addClass("object-visible")}),a(".isotope-container").length>0&&a(window).load(function(){a(".isotope-container").fadeIn();var b=a(".isotope-container").isotope({itemSelector:".isotope-item",layoutMode:"masonry",transitionDuration:"0.6s",filter:"*"});a(".filters").on("click","ul.nav li a",function(){var c=a(this).attr("data-filter");return a(".filters").find("li.active").removeClass("active"),a(this).parent().addClass("active"),b.isotope({filter:c}),!1})}),a(".modal").length>0&&a(".modal").each(function(){a(".modal").prependTo("body")}),a("#submit_travel").on("click touchstart",function(a){}),a("#travel_type").on("click touchstart",chooseTravelType),a("#newTravelBtn").on("click touchend",showTravelForm),a(".datepicker-container-range .input-daterange").datepicker({todayBtn:!0,todayHighlight:!0,autoclose:!0,disableTouchKeyboard:!0}),a(".datepicker-container input").datepicker({autoclose:!0,todayHighlight:!0,disableTouchKeyboard:!0}),a("#findBuddy").on("click touchstart",function(){a("#viewList").trigger("click")}),a("#kakaoLogin").on("click touchstart",function(){a("#kakao-login-btn").trigger("click")}),"/mylist"==window.location.pathname?getMyList():getTravelList(),a(".navbar-collapse ul li a:not(.dropdown-toggle)").bind("click touchstart",function(){"login_name"==event.target.id&&"dropdown-toggle"!=event.target.className&&(event.preventDefault(),a(".navbar-toggle:visible").click())}),window.innerWidth<767&&(info_div_width=window.innerWidth-130),a("form").validate({rules:{kakaotalkID:{required:!0},start:{required:!0},end:{required:!0}},messages:{kakaotalkID:{required:"*"},start:{required:"*"},end:{required:"*"}},highlight:function(b){a(b).closest(".form-group").addClass("has-error")},unhighlight:function(b){a(b).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(a,b){b.parent(".input-group").length?a.insertAfter(b.parent()):a.insertAfter(b)},submitHandler:function(){addNewTravel()}})})}(this.jQuery);